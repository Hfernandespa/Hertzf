<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Banco de Dados CAFL - Harmonizador Fernandes</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<style>
:root {
--primary-color: #3b82f6;
--secondary-color: #8b5cf6;
--accent-color: #f59e0b;
--success-color: #10b981;
--warning-color: #fbbf24;
--danger-color: #ef4444;
--dark-bg: #1e293b;
--darker-bg: #0f172a;
--card-bg: #1f2937;
--text-primary: #ffffff;
--text-secondary: #9ca3af;
}
body {
background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
min-height: 100vh;
}
.database-container {
background: rgba(30, 41, 59, 0.8);
backdrop-filter: blur(10px);
border: 1px solid rgba(255, 255, 255, 0.1);
}
.search-highlight {
background-color: rgba(59, 130, 246, 0.3);
padding: 0 2px;
border-radius: 2px;
}
.frequency-card {
transition: all 0.3s ease;
border: 1px solid rgba(255, 255, 255, 0.1);
}
.frequency-card:hover {
transform: translateY(-2px);
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
border-color: var(--primary-color);
}
.category-badge {
font-size: 0.75rem;
padding: 0.25rem 0.75rem;
border-radius: 9999px;
}
.filter-section {
background: rgba(15, 23, 42, 0.6);
border: 1px solid rgba(255, 255, 255, 0.1);
}
.stats-card {
background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
border-left: 4px solid var(--primary-color);
}
.modal-content {
background: linear-gradient(135deg, #1e293b, #334155);
border: 2px solid var(--primary-color);
}
/* Scrollbar personalizada */
.custom-scrollbar::-webkit-scrollbar {
width: 8px;
height: 8px;
}
.custom-scrollbar::-webkit-scrollbar-track {
background: rgba(255, 255, 255, 0.1);
border-radius: 4px;
}
.custom-scrollbar::-webkit-scrollbar-thumb {
background: var(--primary-color);
border-radius: 4px;
}
.custom-scrollbar::-webkit-scrollbar-thumb:hover {
background: var(--secondary-color);
}
/* Animações */
@keyframes fadeIn {
from { opacity: 0; transform: translateY(20px); }
to { opacity: 1; transform: translateY(0); }
}
.fade-in {
animation: fadeIn 0.5s ease-out;
}
/* Loading spinner */
.spinner {
border: 3px solid rgba(255, 255, 255, 0.3);
border-radius: 50%;
border-top: 3px solid var(--primary-color);
width: 40px;
height: 40px;
animation: spin 1s linear infinite;
}
@keyframes spin {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}
/* Header Styles */
.header-gradient {
background: linear-gradient(135deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.95)),
url('https://images.unsplash.com/photo-1518709268805-4e9042af2176?q=80&w=2070&auto=format&fit=crop') center/cover;
}

/* === Estilos do Gerador === */
.generator-panel {
background: rgba(30, 41, 59, 0.95);
border-radius: 16px;
padding: 24px;
margin-bottom: 24px;
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
border: 1px solid rgba(59, 130, 246, 0.3);
max-height: 0;
overflow: hidden;
transition: max-height 0.4s ease, padding 0.4s ease, margin 0.4s ease;
}
.generator-panel.expanded {
max-height: 1200px;
padding: 24px;
margin-bottom: 24px;
}
.generator-title {
font-size: 1.5rem;
font-weight: bold;
margin-bottom: 16px;
color: #3b82f6;
}
.frequency-input-group {
display: flex;
gap: 1rem;
align-items: flex-end;
margin-bottom: 16px;
}
.frequency-controls {
flex: 1;
}
.wave-visualizer-small {
width: 120px;
height: 80px;
flex-shrink: 0;
background: linear-gradient(to bottom, var(--dark-bg), var(--darker-bg));
border-radius: 8px;
}
.wave-visualizer-small canvas {
width: 100%;
height: 100%;
display: block;
}
.timer-container {
display: none;
margin-top: 16px;
padding: 12px;
background: rgba(30, 41, 59, 0.8);
border-radius: 8px;
}
.timer-display {
font-family: 'Courier New', monospace;
font-size: 1.25rem;
font-weight: bold;
color: #fbbf24;
text-align: center;
margin-bottom: 8px;
}
.timer-progress {
height: 6px;
background: rgba(255, 255, 255, 0.1);
border-radius: 3px;
overflow: hidden;
}
.timer-progress-bar {
height: 100%;
background: #8b5cf6;
width: 0%;
transition: width 1s linear;
}

/* Responsividade */
@media (max-width: 768px) {
.frequency-input-group {
flex-direction: column;
}
.wave-visualizer-small {
width: 100%;
height: 100px;
}
}
</style>
</head>
<body>
<!-- Header -->
<header class="header-gradient border-b border-gray-700">
<div class="container mx-auto px-4 py-6">
<div class="flex flex-col md:flex-row justify-between items-center">
<div class="flex items-center space-x-4">
<a href="index.html" class="flex items-center space-x-2">
<i class="fas fa-wave-square text-3xl text-blue-400"></i>
<div>
<h1 class="text-2xl font-bold text-white">Harmonizador Fernandes</h1>
<p class="text-sm text-blue-200">Banco de Dados CAFL</p>
</div>
</a>
</div>
<nav class="mt-4 md:mt-0">
<div class="flex space-x-6">
<a href="index.html" class="text-blue-400 hover:text-blue-300 transition">
<i class="fas fa-home mr-1"></i>Início
</a>
<a href="#" class="text-green-400 font-semibold">
<i class="fas fa-database mr-1"></i>Banco de Dados
</a>
</div>
</nav>
</div>
</div>
</header>

<div class="container mx-auto px-4 py-8 max-w-7xl">
<!-- Botão Abrir Gerador -->
<div class="text-center mb-6">
<button id="toggleGenerator" class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg font-medium transition transform hover:scale-105">
<i class="fas fa-wave-square mr-2"></i>Abrir Gerador
</button>
</div>

<!-- Painel do Gerador (inicialmente oculto) -->
<div id="generatorPanel" class="generator-panel">
<h2 class="generator-title"><i class="fas fa-wave-square mr-2"></i>Gerador de Frequências</h2>
<div class="space-y-4">
<!-- Frequency Input e Visualizer -->
<div class="frequency-input-group">
<div class="frequency-controls">
<label for="frequency" class="block text-sm font-medium mb-2">Frequência (Hz)</label>
<div class="flex gap-2">
<input type="number" id="frequency" class="flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 transition" placeholder="Digite a frequência" value="40" min="20" max="20000" step="1">
<button id="playBtn" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg font-medium transition">Tocar</button>
<button id="stopBtn" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded-lg font-medium transition hidden">Parar</button>
</div>
</div>
<div class="wave-visualizer-small">
<h3 class="text-xs font-medium mb-1 text-gray-400 text-center">Onda em Tempo Real</h3>
<canvas id="waveCanvas" width="120" height="80"></canvas>
</div>
</div>

<!-- Volume -->
<div>
<label for="volume" class="block text-sm font-medium mb-2">Volume: <span id="volumeValue">50</span>%</label>
<input type="range" id="volume" class="w-full h-2 bg-gray-700 rounded-lg" min="0" max="100" value="50">
</div>

<!-- Tipo de Onda -->
<div>
<label class="block text-sm font-medium mb-2">Tipo de Onda</label>
<div class="grid grid-cols-4 gap-2">
<button class="wave-type-btn bg-blue-600 hover:bg-blue-700 px-2 py-1.5 rounded text-xs transition" data-wave="sine">Senoidal</button>
<button class="wave-type-btn bg-gray-700 hover:bg-gray-600 px-2 py-1.5 rounded text-xs transition" data-wave="square">Quadrada</button>
<button class="wave-type-btn bg-gray-700 hover:bg-gray-600 px-2 py-1.5 rounded text-xs transition" data-wave="sawtooth">Serra</button>
<button class="wave-type-btn bg-gray-700 hover:bg-gray-600 px-2 py-1.5 rounded text-xs transition" data-wave="triangle">Triangular</button>
</div>
</div>

<!-- Timer -->
<div>
<button id="timerBtn" class="bg-purple-600 hover:bg-purple-700 w-full py-2 rounded-lg font-medium transition">Programar Timer</button>
</div>

<div id="timerContainer" class="timer-container">
<div id="timerDisplay">00:00:00</div>
<div class="timer-progress">
<div id="timerProgressBar" class="timer-progress-bar"></div>
</div>
</div>

<!-- Informações da Frequência -->
<div id="currentInfo" class="bg-gray-800 rounded p-3 mt-4">
<div class="text-xl font-bold text-blue-400">40 Hz</div>
<div class="text-lg font-medium">Foco e Concentração</div>
</div>
<div id="currentDetails" class="bg-gray-800 rounded p-3 text-sm mt-2">
<div><strong>Categoria:</strong> <span class="category-badge bg-blue-600">Concentração</span></div>
<div><strong>Descrição:</strong> Frequência para melhorar foco cognitivo e clareza mental.</div>
</div>
<div id="waveRecommendation" class="bg-gray-800 rounded p-3 text-sm mt-2">
<div class="flex items-center gap-2">
<i class="fas fa-lightbulb text-yellow-500"></i>
<span><strong>Onda recomendada:</strong> Senoidal</span>
</div>
</div>
</div>
</div>

<!-- Restante do conteúdo original... -->
<div class="text-center mb-8">
<h1 class="text-4xl font-bold mb-2 bg-gradient-to-r from-green-400 to-blue-600 bg-clip-text text-transparent">
Banco de Dados CAFL
</h1>
<p class="text-gray-400 text-lg">Consolidated Annotated Frequency List - v2023_05_25</p>
<p class="text-gray-500 text-sm mt-2">Fonte: turf@mindspring.com</p>
</div>

<!-- Estatísticas -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
<div class="stats-card rounded-lg p-4">
<div class="flex items-center justify-between">
<div>
<p class="text-gray-400 text-sm">Total Frequências</p>
<p class="text-2xl font-bold text-white" id="totalCount">0</p>
</div>
<i class="fas fa-wave-square text-3xl text-blue-400"></i>
</div>
</div>
<!-- ... (mantido igual ao original para brevidade) ... -->
<!-- Main Database Container -->
<div class="database-container rounded-xl p-6 shadow-2xl">
<!-- ... (filtros e resultados mantidos intactos) ... -->
</div>
</div>

<!-- Modal de Detalhes -->
<div id="detailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
<!-- ... (modal original) ... -->
</div>

<script>
// === AUDIO ENGINE ===
let audioContext;
let oscillator;
let gainNode;
let isPlaying = false;
let currentWaveType = 'sine';
let currentFreq = 40;
let timerInterval = null;
let isTimerActive = false;
let timerSeconds = 0;

function initAudioContext() {
if (!audioContext) {
audioContext = new (window.AudioContext || window.webkitAudioContext)();
}
}

function drawWave() {
const canvas = document.getElementById('waveCanvas');
if (!canvas) return;
const ctx = canvas.getContext('2d');
const width = canvas.width;
const height = canvas.height;
ctx.clearRect(0, 0, width, height);
ctx.strokeStyle = '#3b82f6';
ctx.lineWidth = 2;
ctx.beginPath();
const amplitude = height / 3;
const centerY = height / 2;
const freq = currentFreq / 100;
for (let x = 0; x < width; x++) {
let y;
switch (currentWaveType) {
case 'sine':
y = centerY + amplitude * Math.sin(x * freq * 0.1);
break;
case 'square':
y = centerY + amplitude * (Math.sin(x * freq * 0.1) > 0 ? 1 : -1);
break;
case 'sawtooth':
y = centerY + amplitude * (2 * (x * freq * 0.1 / (2 * Math.PI) - Math.floor(0.5 + x * freq * 0.1 / (2 * Math.PI))));
break;
case 'triangle':
const t = (x * freq * 0.1) % (2 * Math.PI);
y = centerY + amplitude * (2 * Math.abs(2 * (t / (2 * Math.PI) - Math.floor(t / (2 * Math.PI) + 0.5))) - 1);
break;
default:
y = centerY;
}
if (x === 0) ctx.moveTo(x, y);
else ctx.lineTo(x, y);
}
ctx.stroke();
if (isPlaying) requestAnimationFrame(drawWave);
}

function playTone() {
if (isPlaying) return;
initAudioContext();
currentFreq = parseFloat(document.getElementById('frequency').value) || 40;
oscillator = audioContext.createOscillator();
gainNode = audioContext.createGain();
oscillator.type = currentWaveType;
oscillator.frequency.setValueAtTime(currentFreq, audioContext.currentTime);
const vol = document.getElementById('volume').value / 100;
gainNode.gain.setValueAtTime(vol, audioContext.currentTime);
oscillator.connect(gainNode);
gainNode.connect(audioContext.destination);
oscillator.start();
isPlaying = true;
document.getElementById('playBtn').classList.add('hidden');
document.getElementById('stopBtn').classList.remove('hidden');
drawWave();
}

function stopTone() {
if (!isPlaying) return;
if (oscillator) {
oscillator.stop();
oscillator.disconnect();
oscillator = null;
}
if (gainNode) {
gainNode.disconnect();
gainNode = null;
}
isPlaying = false;
document.getElementById('playBtn').classList.remove('hidden');
document.getElementById('stopBtn').classList.add('hidden');
if (isTimerActive) stopTimer();
}

function startTimer() {
const mins = prompt("Minutos:", "5");
if (!mins || isNaN(mins)) return;
timerSeconds = parseInt(mins) * 60;
isTimerActive = true;
document.getElementById('timerContainer').style.display = 'block';
updateTimerDisplay();
timerInterval = setInterval(() => {
timerSeconds--;
updateTimerDisplay();
const total = parseInt(mins) * 60;
document.getElementById('timerProgressBar').style.width = `${((total - timerSeconds) / total) * 100}%`;
if (timerSeconds <= 0) {
stopTimer();
stopTone();
alert("Timer concluído!");
}
}, 1000);
}

function stopTimer() {
if (timerInterval) clearInterval(timerInterval);
isTimerActive = false;
document.getElementById('timerContainer').style.display = 'none';
}

function updateTimerDisplay() {
const h = Math.floor(timerSeconds / 3600);
const m = Math.floor((timerSeconds % 3600) / 60);
const s = timerSeconds % 60;
document.getElementById('timerDisplay').textContent =
`${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
}

// === CONTROLES DO GERADOR ===
document.getElementById('toggleGenerator').addEventListener('click', () => {
const panel = document.getElementById('generatorPanel');
panel.classList.toggle('expanded');
const btn = document.getElementById('toggleGenerator');
btn.innerHTML = panel.classList.contains('expanded') ?
'<i class="fas fa-times mr-2"></i>Fechar Gerador' :
'<i class="fas fa-wave-square mr-2"></i>Abrir Gerador';
});

document.getElementById('playBtn').addEventListener('click', playTone);
document.getElementById('stopBtn').addEventListener('click', stopTone);
document.getElementById('timerBtn').addEventListener('click', startTimer);

document.getElementById('volume').addEventListener('input', () => {
const v = document.getElementById('volume').value;
document.getElementById('volumeValue').textContent = v;
if (gainNode) gainNode.gain.setValueAtTime(v / 100, audioContext.currentTime);
});

document.querySelectorAll('.wave-type-btn').forEach(btn => {
btn.addEventListener('click', () => {
currentWaveType = btn.dataset.wave;
document.querySelectorAll('.wave-type-btn').forEach(b => {
b.classList.remove('bg-blue-600');
b.classList.add('bg-gray-700');
});
btn.classList.remove('bg-gray-700');
btn.classList.add('bg-blue-600');
if (isPlaying && oscillator) oscillator.type = currentWaveType;
});
});

// === INTEGRAÇÃO COM BANCO DE DADOS ===
function updateGeneratorFromFreq(freqObj) {
document.getElementById('frequency').value = freqObj.frequency.split(',')[0];
document.getElementById('currentInfo').innerHTML = `
<div class="text-xl font-bold text-blue-400">${freqObj.frequency.split(',')[0]} Hz</div>
<div class="text-lg font-medium">${freqObj.name}</div>
`;
// Categoria legível
const catNames = {
'inflamacao': 'Inflamação',
'dor': 'Dor',
'bacteria': 'Bactéria',
'virus': 'Vírus',
'fungo': 'Fungo',
'cancer': 'Câncer',
'parasita': 'Parasita',
'respiratorio': 'Respiratório',
'pele': 'Pele',
'mental': 'Mental/Emocional',
'sistema-nervoso': 'Sistema Nervoso',
'sistema-digestivo': 'Sistema Digestivo',
'geral': 'Geral'
};
document.getElementById('currentDetails').innerHTML = `
<div><strong>Categoria:</strong> <span class="category-badge bg-blue-600">${catNames[freqObj.category] || freqObj.category}</span></div>
<div><strong>Descrição:</strong> ${freqObj.description}</div>
`;
// Recomendação de onda
let rec = 'Senoidal';
if (['bacteria', 'virus', 'parasita'].includes(freqObj.category)) rec = 'Quadrada';
document.getElementById('waveRecommendation').innerHTML = `
<div class="flex items-center gap-2">
<i class="fas fa-lightbulb text-yellow-500"></i>
<span><strong>Onda recomendada:</strong> ${rec}</span>
</div>
`;
// Abrir painel se fechado
const panel = document.getElementById('generatorPanel');
if (!panel.classList.contains('expanded')) {
panel.classList.add('expanded');
document.getElementById('toggleGenerator').innerHTML = '<i class="fas fa-times mr-2"></i>Fechar Gerador';
}
}

// === RESTANTE DO CÓDIGO ORIGINAL DO BANCO DE DADOS ===
// (Incluindo processCAFLData, filtros, renderização, etc.)
// ... (mesmo código da sua database.txt original, com uma única alteração na função useFrequency)

// Substitua sua função useFrequency() por esta:
function useFrequencyEnhanced(id) {
const freq = database.frequencies.find(f => f.id === id);
if (freq) {
updateGeneratorFromFreq(freq);
if (!isPlaying) {
setTimeout(playTone, 300); // pequeno delay para garantir que o valor foi atualizado
}
}
}

// Agora, injetamos essa substituição na classe original
const originalDatabase = FrequencyDatabase;
class FrequencyDatabase extends originalDatabase {
useFrequency(id) {
useFrequencyEnhanced(id);
}
}

// Inicialização (mesma do original)
const caflData = `CAFL
Lista de frequências anotadas consolidada, v2023_05_25, turf@mindspring.com
Todas as frequências em Hz
Inflamação abdominal - 2720, 2489, 2170, 2000, 1865, 1800, 1600, 1550, 880, 832, 802, 787, 776, 727, 660, 465, 450, 444, 440, 428, 380, 250, 146, 125, 95, 72, 20, 1,2
Dor abdominal - 10000, 3000, 95, 3
/* ... (todo o resto do CAFL aqui igual ao seu arquivo) ... */
`;

// Mantenha exatamente o mesmo código de processamento, filtros, etc.
// (Como o espaço é limitado, omiti por brevidade — mas é idêntico ao seu original)

// Inicialize normalmente
const database = new FrequencyDatabase();

// Função global para fechar modal
function closeModal() {
document.getElementById('detailModal').classList.add('hidden');
}
</script>
</body>
</html>
