<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Harmonizador Fernandes v1.5 - Frequências Terapêuticas & Protocolos Personalizados">
    <title>Harmonizador Fernandes - Versão com Banco de Dados Completo</title>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Chart.js para visualizações -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Banco de Dados CAFL -->
    <script src="cafl_database.js"></script>

    <script>
  // Dados das frequências completas (pode ser movido para um arquivo JSON depois)
  const fullProtocols = {
    "Guindaste_inicial_completo": {
      title: "Guindaste Inicial Completo",
      description: "Conjunto completo de frequências para protocolos gerais",
      frequencies: [34750, 31750, 31000, 10000, 5000, 3500, 2720, 2489, 2452, 2250, 2200, 2180, 2130, 2127.5, 2120, 2100, 2093, 2050, 2008, 2000, 1998, 1865, 1862, 1850, 1840, 1800, 1600, 1570, 1560, 1552, 1550, 1500, 1100, 1050, 1027, 1000, 885, 880, 875, 864, 804, 803, 802, 800, 799, 787, 784, 781, 780, 776, 775, 770, 764, 740, 730, 727.5, 725, 712, 700, 690, 676, 666, 664, 660, 650, 625, 622, 600, 500, 465, 450, 440, 432, 428, 423, 400, 304, 250, 240, 162, 160, 125, 121, 120, 100, 95, 82, 81, 80, 78, 72, 70, 60, 41, 36, 30, 28, 26, 22, 20, 18, 15, 14, 13, 10, 9, 8, 7, 5.5, 5, 4, 3.5, 1.8, 1]
    },
    "ALS_2": {
      title: "ALS_2 - Potenciais Vírus Causadores",
      description: "Esclerose Lateral Amiotrófica tipo 2 - Frequências para potenciais vírus causadores",
      frequencies: [5000, 3636, 2632, 1850, 1500, 1488, 1422, 1189, 1044, 922, 868, 845, 822, 788, 776, 766, 742, 733, 721, 676, 654, 625, 620, 607, 608, 609, 610, 611, 612, 613, 595, 515, 487, 461, 435, 423, 380, 322, 283, 232, 144, 136, 20]
    },
    "Câncer": {
      title: "Câncer - Conjunto Básico Abrangente",
      description: "Conjunto básico abrangente para tratamento de câncer",
      frequencies: [10000, 11780, 21275, 17034, 11430, 10025, 6766, 6064, 5000, 3713, 3176, 3040, 2950, 2876, 2790, 2720, 2452, 2189, 2182, 2128, 2127, 2084, 2048, 2008, 1604, 1552, 1489, 880, 854, 800, 784, 776, 766, 728, 690, 683, 676, 666, 524, 464, 333, 120, 20]
    }
  };

  // Função para mostrar protocolo completo em modal
  function showFullProtocol(protocolName) {
    const protocol = fullProtocols[protocolName];
    if (!protocol) return;

    // Criar modal
    const modal = document.createElement('div');
    modal.className = 'protocol-modal';
    modal.innerHTML = `
      <div class="protocol-content">
        <button class="protocol-close" onclick="this.closest('.protocol-modal').remove()">
          <i class="fas fa-times"></i>
        </button>
        
        <div class="protocol-header">
          <h2 class="protocol-title">${protocol.title}</h2>
          <p class="protocol-subtitle">${protocol.description}</p>
          <p class="text-gray-400"><i class="fas fa-wave-square mr-2"></i>${protocol.frequencies.length} frequências</p>
        </div>
        
        <div class="protocol-section">
          <h3 class="detail-section-title">
            <i class="fas fa-list mr-2"></i>Todas as Frequências
          </h3>
          <div class="frequency-list">
            ${protocol.frequencies.map(freq => `
              <div class="frequency-item" onclick="selectFrequencyFromModal(${freq})">
                <div class="frequency-value">${freq}</div>
                <div class="frequency-unit">Hz</div>
              </div>
            `).join('')}
          </div>
        </div>
        
        <div class="mt-6 flex justify-end gap-3">
          <button class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg transition" onclick="this.closest('.protocol-modal').remove()">
            Fechar
          </button>
          <button class="bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded-lg transition" onclick="startProtocol('${protocolName}')">
            <i class="fas fa-play mr-2"></i>Iniciar Protocolo
          </button>
        </div>
      </div>
    `;
    
    document.body.appendChild(modal);
    
    // Fechar modal ao clicar fora
    modal.addEventListener('click', function(e) {
      if (e.target === modal) {
        modal.remove();
      }
    });
  }

  // Função para selecionar frequência do modal
  function selectFrequencyFromModal(freq) {
    document.getElementById('frequency').value = freq;
    updateFrequencyInfo(freq);
    document.querySelector('.protocol-modal').remove();
    document.getElementById('generatorSection').scrollIntoView({ behavior: 'smooth' });
  }

  // Função para iniciar protocolo (placeholder)
  function startProtocol(protocolName) {
    alert(`Iniciando protocolo: ${protocolName}\n\nEsta funcionalidade será implementada em breve!`);
    document.querySelector('.protocol-modal').remove();
  }

  // Adicionar evento de clique aos botões de frequência
  document.addEventListener('DOMContentLoaded', function() {
    const frequencyButtons = document.querySelectorAll('.frequency-btn');
    
    frequencyButtons.forEach(button => {
      button.addEventListener('click', function() {
        const freq = this.getAttribute('data-freq');
        
        // Preencher o campo de frequência
        document.getElementById('frequency').value = freq;
        
        // Atualizar as informações de frequência
        updateFrequencyInfo(freq);
        
        // Adicionar ao histórico
        addToHistory(freq, 'Frequência em Destaque');
        
        // Rolar até o gerador de frequências
        document.getElementById('generatorSection').scrollIntoView({ 
          behavior: 'smooth' 
        });
      });
    });
  });

  // Função para atualizar informações da frequência (mantida do original)
  function updateFrequencyInfo(freq) {
    document.getElementById('currentInfo').innerHTML = `
      <div class="text-xl font-bold text-blue-400">${freq} Hz</div>
      <div class="text-lg font-medium">Frequência em Destaque</div>
    `;
    
    document.getElementById('currentDetails').innerHTML = `
      <div><strong>Categoria:</strong> <span class="category-badge bg-yellow-600">Destaque</span></div>
      <div><strong>Descrição:</strong> Frequência selecionada da base de dados em destaque.</div>
    `;
  }

  // Função para adicionar ao histórico (adaptada do original)
  function addToHistory(freq, source) {
    const historyList = document.getElementById('historyList');
    const historyItem = document.createElement('div');
    historyItem.className = 'flex justify-between items-center p-2 bg-gray-900 rounded-lg';
    historyItem.innerHTML = `
      <span class="text-sm">${freq} Hz - ${source}</span>
      <button class="text-gray-400 hover:text-white" onclick="document.getElementById('frequency').value=${freq}; updateFrequencyInfo(${freq});">
        <i class="fas fa-redo text-xs"></i>
      </button>
    `;
    
    historyList.insertBefore(historyItem, historyList.firstChild);
    
    // Manter apenas os últimos 10 itens
    while (historyList.children.length > 10) {
      historyList.removeChild(historyList.lastChild);
    }
  }
</script>

    <!-- Estilos customizados -->
    <style>
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #8b5cf6;
            --accent-color: #f59e0b;
            --success-color: #10b981;
            --warning-color: #fbbf24;
            --danger-color: #ef4444;
            --dark-bg: #1e293b;
            --darker-bg: #0f172a;
            --card-bg: #1f2937;
            --text-primary: #ffffff;
            --text-secondary: #9ca3af;
        }

        /* Animações */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        /* Estilos do canvas */
        #waveCanvas {
            background: linear-gradient(to bottom, var(--dark-bg), var(--darker-bg));
        }

        /* Cards de frequência */
        .frequency-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .frequency-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            background-color: rgba(59, 130, 246, 0.1);
        }

        .frequency-card.selected {
            background-color: rgba(59, 130, 246, 0.2);
            border: 2px solid var(--primary-color);
        }

        /* Badge de categoria */
        .category-badge {
            font-size: 0.75rem;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
        }

        /* Badge de evidência */
        .evidence-badge {
            font-size: 0.7rem;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-weight: bold;
            margin-left: 0.5rem;
        }

        .evidence-high {
            background-color: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .evidence-medium {
            background-color: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .evidence-low {
            background-color: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }

        /* Destaque de busca */
        .search-highlight {
            background-color: rgba(59, 130, 246, 0.3);
            padding: 0 2px;
            border-radius: 2px;
        }

        /* Passos de protocolo */
        .protocol-step {
            position: relative;
            padding-left: 2rem;
        }

        .protocol-step::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0.5rem;
            width: 1rem;
            height: 1rem;
            border-radius: 50%;
        }

        .protocol-step.energy::before { background: var(--accent-color); }
        .protocol-step.focus::before { background: var(--primary-color); }
        .protocol-step.anti-inflammatory::before { background: var(--success-color); }
        .protocol-step.harmony::before { background: var(--secondary-color); }

        /* Título estilizado */
        .harmonizador-title {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Container do banco de dados */
        .database-container {
            height: 600px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--card-bg);
        }

        .database-container::-webkit-scrollbar {
            width: 8px;
        }

        .database-container::-webkit-scrollbar-track {
            background: var(--card-bg);
        }

        .database-container::-webkit-scrollbar-thumb {
            background-color: var(--primary-color);
            border-radius: 4px;
        }

        /* Estilos do timer */
        .timer-display {
            font-family: 'Courier New', Courier, monospace;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .timer-progress {
            transition: width 1s linear;
        }

        /* Botão voltar ao topo */
        #topBtn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        #topBtn.show {
            opacity: 1;
            visibility: visible;
        }

        #topBtn:hover {
            transform: translateY(-3px);
        }

        /* Destaque de protocolo */
        .protocol-highlight {
            animation: pulse 2s infinite;
        }

        /* Eficiência alta */
        .efficiency-high {
            color: var(--warning-color);
        }

        /* Itens de referência */
        .reference-item {
            position: relative;
            padding-left: 2rem;
        }

        .reference-item::before {
            content: '•';
            position: absolute;
            left: 0;
            top: 0;
        }

        /* Eficiência da onda */
        .wave-efficiency {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Input do timer */
        .timer-input {
            width: 3rem;
            text-align: center;
        }

        /* Melhorias de acessibilidade */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Melhorias de foco para acessibilidade */
        button:focus,
        input:focus,
        select:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        /* Melhorias para modo de alto contraste */
        @media (prefers-contrast: high) {
            .frequency-card:hover,
            .frequency-card.selected {
                border-width: 3px;
            }
        }

        /* Melhorias para redução de movimento */
        @media (prefers-reduced-motion: reduce) {
            .frequency-card,
            #topBtn,
            .timer-progress,
            .protocol-highlight {
                transition: none;
                animation: none;
            }
        }

        /* Container de referências com rolagem */
        .references-container {
            max-height: 400px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--card-bg);
        }

        .references-container::-webkit-scrollbar {
            width: 8px;
        }

        .references-container::-webkit-scrollbar-track {
            background: var(--card-bg);
        }

        .references-container::-webkit-scrollbar-thumb {
            background-color: var(--primary-color);
            border-radius: 4px;
        }

        /* Layout do Visualizador de Onda ao lado da Frequência */
        .frequency-input-group {
            display: flex;
            gap: 1rem;
            align-items: flex-end;
        }

        .frequency-controls {
            flex: 1;
        }

        .wave-visualizer-small {
            width: 120px;
            height: 80px;
            flex-shrink: 0;
        }

        /* Responsividade para telas pequenas */
        @media (max-width: 768px) {
            .frequency-input-group {
                flex-direction: column;
                align-items: stretch;
            }

            .wave-visualizer-small {
                width: 100%;
                height: 100px;
                margin-top: 1rem;
            }
        }
        
        /* Destaque para áreas editáveis */
        .editable-area {
            border: 2px dashed var(--warning-color);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            position: relative;
        }
        
        .editable-label {
            position: absolute;
            top: -12px;
            left: 15px;
            background: var(--dark-bg);
            padding: 0 8px;
            font-size: 12px;
            color: var(--warning-color);
            font-weight: bold;
        }
        
        /* Cards de benefícios */
        .benefit-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(139, 92, 246, 0.1));
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid var(--primary-color);
        }
        
        .benefit-card h4 {
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .benefit-card p {
            color: var(--text-secondary);
            font-size: 0.875rem;
            line-height: 1.5;
        }
        
        /* Seção Hero no topo */
        .hero-section {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.9), rgba(15, 23, 42, 0.9)), 
                        url('https://images.unsplash.com/photo-1648080473344-a399955ac123?q=80&w=1974&auto=format&fit=crop') center/cover;
            border-radius: 16px;
            padding: 3rem 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        
        .hero-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 70% 30%, rgba(59, 130, 246, 0.2) 0%, transparent 50%);
            z-index: 0;
        }
        
        .hero-content {
            position: relative;
            z-index: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }
        
        .hero-title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero-subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            max-width: 700px;
            margin-bottom: 2rem;
        }
        
        .hero-features {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .hero-feature {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            width: 180px;
            animation: float 3s ease-in-out infinite;
        }
        
        .hero-feature:nth-child(2) {
            animation-delay: 0.5s;
        }
        
        .hero-feature:nth-child(3) {
            animation-delay: 1s;
        }
        
        .hero-feature:nth-child(4) {
            animation-delay: 1.5s;
        }
        
        .hero-feature-icon {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hero-feature-title {
            font-weight: bold;
            margin-bottom: 0.25rem;
            color: var(--text-primary);
        }
        
        .hero-feature-text {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        .hero-cta {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }
        
        .hero-cta:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.6);
        }
        
        /* Responsividade para a seção hero */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2rem;
            }
            
            .hero-subtitle {
                font-size: 1rem;
            }
            
            .hero-features {
                gap: 1.5rem;
            }
            
            .hero-feature {
                width: 150px;
            }
            
            .hero-feature-icon {
                font-size: 2rem;
            }
        }
        
        /* Cabeçalho com imagem de fundo */
        .header-with-bg {
            background: linear-gradient(to right, rgba(15, 23, 42, 0.85), rgba(30, 41, 59, 0.85)), 
                        url('https://images.unsplash.com/photo-1518709268805-4e9042af2176?q=80&w=2070&auto=format&fit=crop') center/cover;
            position: relative;
            overflow: hidden;
        }
        
        .header-with-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 50%, rgba(59, 130, 246, 0.15) 0%, transparent 70%);
            z-index: 0;
        }
        
        .header-content {
            position: relative;
            z-index: 1;
        }
        
        /* Efeito de brilho no título */
        .title-glow {
            text-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
        }

        /* Seção de Referências Científicas */
        .references-section {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 2rem;
            margin-top: 3rem;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .reference-card {
            background: rgba(59, 130, 246, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-left: 4px solid var(--primary-color);
            transition: all 0.3s ease;
        }

        .reference-card:hover {
            background: rgba(59, 130, 246, 0.1);
            transform: translateY(-2px);
        }

        .reference-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
        }

        .reference-authors {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
        }

        .reference-journal {
            color: var(--text-secondary);
            font-style: italic;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .reference-summary {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .reference-doi {
            display: inline-block;
            margin-top: 0.5rem;
            color: var(--primary-color);
            font-size: 0.8rem;
            text-decoration: none;
        }

        .reference-doi:hover {
            text-decoration: underline;
        }

        /* Botão Mais Frequências */
        .more-frequencies-btn {
            background: linear-gradient(135deg, var(--success-color), var(--primary-color));
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            margin: 3rem auto 0;
            max-width: 300px;
        }

        .more-frequencies-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.6);
        }

        /* Modal de Banco de Dados Completo */
        .database-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            overflow-y: auto;
            padding: 2rem;
        }

        .database-modal-content {
            background: linear-gradient(135deg, #1e293b, #334155);
            border-radius: 16px;
            padding: 2rem;
            max-width: 1200px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
            border: 2px solid var(--primary-color);
            position: relative;
        }

        .database-modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: var(--danger-color);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            transition: background 0.3s ease;
        }

        .database-modal-close:hover {
            background: #dc2626;
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Cabeçalho com imagem de fundo -->
        <header class="header-with-bg p-8 shadow-2xl rounded-b-2xl" role="banner">
            <div class="header-content container mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
                <div>
                    <h1 class="text-4xl md:text-5xl font-bold harmonizador-title title-glow">Harmonizador Fernandes</h1>
                    <p class="text-blue-200 mt-2 text-lg">Frequências Terapêuticas & Protocolos Personalizados</p>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- hitwebcounter Code START -->
                    <a href="https://www.hitwebcounter.com" target="_blank">
                        <img src="https://hitwebcounter.com/counter/counter.php?page=21436820&style=0006&nbdigits=6&type=ip&initCount=0" title="Conversions and Hits" alt="Conversions and Hits" border="0" />
                    </a>
                    <!-- hitwebcounter Code END -->
                </div>
            </div>
        </header>

        <!-- Seção Hero -->
        <section class="hero-section">
            <div class="hero-content">
                <h2 class="hero-title">Equilibre Sua Energia Vital</h2>
                <p class="hero-subtitle">
                    Descubra o poder das frequências terapêuticas para transformar seu bem-estar físico, mental e emocional com protocolos personalizados e cientificamente desenvolvidos.
                </p>
                
                <div class="hero-features">
                    <div class="hero-feature">
                        <div class="hero-feature-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <h3 class="hero-feature-title">Foco & Clareza</h3>
                        <p class="hero-feature-text">Aumente sua concentração e capacidade cognitiva</p>
                    </div>
                    
                    <div class="hero-feature">
                        <div class="hero-feature-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <h3 class="hero-feature-title">Energia Vital</h3>
                        <p class="hero-feature-text">Combata a fadiga e recupere sua vitalidade</p>
                    </div>
                    
                    <div class="hero-feature">
                        <div class="hero-feature-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <h3 class="hero-feature-title">Equilíbrio Emocional</h3>
                        <p class="hero-feature-text">Encontre paz interior e bem-estar</p>
                    </div>
                    
                    <div class="hero-feature">
                        <div class="hero-feature-icon">
                            <i class="fas fa-moon"></i>
                        </div>
                        <h3 class="hero-feature-title">Sono Reparador</h3>
                        <p class="hero-feature-text">Melhore a qualidade do seu descanso</p>
                    </div>
                </div>
                
                <button class="hero-cta" onclick="document.getElementById('generatorSection').scrollIntoView({behavior: 'smooth'})">
                    Começar Agora <i class="fas fa-arrow-down ml-2"></i>
                </button>
            </div>
        </section>

        <!-- Conteúdo Principal -->
        <main>
            <!-- Seção do Gerador de Frequências -->
            <section id="generatorSection" class="mb-12">
                <div class="grid lg:grid-cols-12 gap-8">
                    <!-- Coluna 1: Gerador de Frequências + Histórico -->
                    <div class="lg:col-span-5 space-y-6">
                        <section class="bg-gray-800 rounded-xl p-6 shadow-2xl">
                            <h2 class="text-2xl font-semibold mb-6 text-blue-400" id="generator-heading"><i class="fas fa-wave-square mr-2" aria-hidden="true"></i>Gerador de Frequências</h2>

                            <div class="space-y-4">
                                <!-- Frequency Input e Visualizer -->
                                <div class="frequency-input-group">
                                    <div class="frequency-controls">
                                        <label for="frequency" class="block text-sm font-medium mb-2">Frequência (Hz)</label>
                                        <div class="flex gap-2">
                                            <input type="number" id="frequency" class="flex-1 bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 transition" placeholder="Digite a frequência" value="40" min="20" max="20000" step="1" aria-describedby="frequency-description">
                                            <button id="playBtn" class="bg-blue-600 hover:bg-blue-700 px-6 py-2 rounded-lg font-medium transition transform hover:scale-105" aria-label="Tocar frequência">
                                                <i class="fas fa-play mr-2" aria-hidden="true"></i>Tocar
                                            </button>
                                            <button id="stopBtn" class="bg-red-600 hover:bg-red-700 px-6 py-2 rounded-lg font-medium transition transform hover:scale-105 hidden" aria-label="Parar frequência">
                                                <i class="fas fa-stop mr-2" aria-hidden="true"></i>Parar
                                            </button>
                                        </div>
                                        <div id="frequency-description" class="sr-only">Insira uma frequência entre 20 Hz e 20.000 Hz</div>
                                    </div>
                                    <div class="wave-visualizer-small bg-gray-900 rounded-lg p-2">
                                        <h3 class="text-xs font-medium mb-1 text-gray-400 text-center">Onda em Tempo Real</h3>
                                        <canvas id="waveCanvas" width="120" height="80" class="w-full h-full rounded" aria-label="Visualização da forma de onda"></canvas>
                                    </div>
                                </div>

                                <!-- Volume Control -->
                                <div>
                                    <label for="volume" class="block text-sm font-medium mb-2">Volume: <span id="volumeValue">50</span>%</label>
                                    <input type="range" id="volume" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer" min="0" max="100" value="50" aria-describedby="volume-description">
                                    <div id="volume-description" class="sr-only">Ajuste o volume de 0% a 100%</div>
                                </div>

                                <!-- Wave Type Selection -->
                                <div>
                                    <label class="block text-sm font-medium mb-2">Tipo de Onda</label>
                                    <div class="grid grid-cols-4 gap-2">
                                        <button class="wave-type-btn bg-blue-600 hover:bg-blue-700 px-3 py-2 rounded-lg text-sm transition" data-wave="sine" aria-label="Onda Senoidal">
                                            <i class="fas fa-wave-square mr-1" aria-hidden="true"></i>Senoidal
                                        </button>
                                        <button class="wave-type-btn bg-gray-700 hover:bg-gray-700 px-3 py-2 rounded-lg text-sm transition" data-wave="square" aria-label="Onda Quadrada">
                                            <i class="fas fa-square-wave mr-1" aria-hidden="true"></i>Quadrada
                                        </button>
                                        <button class="wave-type-btn bg-gray-700 hover:bg-gray-700 px-3 py-2 rounded-lg text-sm transition" data-wave="sawtooth" aria-label="Onda Dente de Serra">
                                            <i class="fas fa-wave-triangle mr-1" aria-hidden="true"></i>Serra
                                        </button>
                                        <button class="wave-type-btn bg-gray-700 hover:bg-gray-700 px-3 py-2 rounded-lg text-sm transition" data-wave="triangle" aria-label="Onda Triangular">
                                            <i class="fas fa-wave-triangle mr-1" aria-hidden="true"></i>Triangular
                                        </button>
                                    </div>
                                </div>

                                <!-- Timer -->
                                <div>
                                    <button id="timerBtn" class="bg-purple-600 hover:bg-purple-700 px-4 py-2 rounded-lg font-medium transition transform hover:scale-105 w-full" aria-label="Definir timer">
                                        <i class="fas fa-clock mr-2" aria-hidden="true"></i>Programar Timer
                                    </button>
                                </div>
                                <div class="mt-3 bg-gray-900 rounded-lg p-3 hidden" id="timerContainer">
                                    <div class="flex justify-between items-center mb-2">
                                        <span class="text-sm text-gray-400">Tempo Restante</span>
                                        <div id="timerDisplay" class="timer-display text-blue-400">00:00:00</div>
                                    </div>
                                    <div class="w-full bg-gray-700 rounded-full h-2">
                                        <div id="timerProgress" class="timer-progress bg-purple-600 h-full rounded-full" style="width: 0%"></div>
                                    </div>
                                </div>

                                <!-- Current Frequency Info -->
                                <div id="currentInfo" class="bg-gray-900 rounded-lg p-4">
                                    <div class="text-xl font-bold text-blue-400">40 Hz</div>
                                    <div class="text-lg font-medium">Foco e Concentração</div>
                                </div>
                                <div id="currentDetails" class="bg-gray-900 rounded-lg p-4 text-sm">
                                    <div><strong>Categoria:</strong> <span class="category-badge bg-blue-600">Concentração</span></div>
                                    <div><strong>Descrição:</strong> Frequência para melhorar foco cognitivo e clareza mental.</div>
                                </div>
                                <div id="waveRecommendation" class="bg-gray-900 rounded-lg p-4 text-sm">
                                    <div class="flex items-center gap-2">
                                        <i class="fas fa-lightbulb text-yellow-500"></i>
                                        <span><strong>Onda recomendada:</strong> Senoidal - Proporciona uma experiência mais suave e agradável para estimulação cognitiva.</span>
                                    </div>
                                </div>

                                <!-- Favorite Button -->
                                <button id="favoriteBtn" class="bg-gray-700 hover:bg-gray-600 px-4 py-2 rounded-lg font-medium transition w-full" aria-label="Adicionar aos favoritos">
                                    <i class="far fa-star mr-2"></i>Adicionar aos Favoritos
                                </button>
                            </div>
                        </section>

                        <!-- Seção de Histórico -->
                        <section class="bg-gray-800 rounded-xl p-6 shadow-2xl" aria-labelledby="history-heading">
                            <h3 id="history-heading" class="text-lg font-semibold mb-4 text-purple-400"><i class="fas fa-history mr-2" aria-hidden="true"></i>Histórico Recente</h3>
                            <div id="historyList" class="space-y-1 max-h-32 overflow-y-auto" aria-live="polite">
                                <!-- Itens do histórico serão adicionados aqui -->
                            </div>
                        </section>
                    </div>

                    <!-- Coluna 2: Frequências Principais -->
                    <div class="lg:col-span-7 space-y-6">
                        <section class="bg-gray-800 rounded-xl p-6 shadow-2xl" aria-labelledby="main-frequencies-heading">
                            <div class="flex justify-between items-center mb-6">
                                <h2 id="main-frequencies-heading" class="text-2xl font-semibold text-green-400"><i class="fas fa-star mr-2" aria-hidden="true"></i>Frequências Principais</h2>
                                <div class="text-sm text-gray-400"><span id="mainResultCount">5</span> frequências terapêuticas</div>
                            </div>
                            
                            <!-- Container de Frequências Principais -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="mainFrequenciesList">
                                <!-- Cards de frequência serão adicionados aqui -->
                            </div>
                        </section>

                        <!-- Benefícios das Frequências -->
                        <section class="bg-gray-800 rounded-xl p-6 shadow-2xl">
                            <h2 class="text-2xl font-semibold mb-6 text-yellow-400"><i class="fas fa-lightbulb mr-2" aria-hidden="true"></i>Benefícios das Frequências Terapêuticas</h2>
                            
                            <div class="space-y-3">
                                <div class="benefit-card">
                                    <h4><i class="fas fa-bolt text-yellow-400"></i> Energia e Vitalidade</h4>
                                    <p>Frequências específicas como 25 Hz e 50 Hz ajudam a aumentar os níveis de energia, combater a fadiga e melhorar a disposição para atividades diárias.</p>
                                </div>
                                
                                <div class="benefit-card">
                                    <h4><i class="fas fa-brain text-blue-400"></i> Foco e Concentração</h4>
                                    <p>Frequências na faixa de 40 Hz (ondas Gama) estão associadas à melhora da cognição, memória e capacidade de concentração prolongada.</p>
                                </div>
                                
                                <div class="benefit-card">
                                    <h4><i class="fas fa-heart text-red-400"></i> Bem-Estar Emocional</h4>
                                    <p>Frequências como 285 Hz e 639 Hz podem ajudar a reduzir sintomas de depressão, ansiedade e promover equilíbrio emocional.</p>
                                </div>
                            </div>
                        </section>

                        <!-- Botão Mais Frequências -->
                        <button id="moreFrequenciesBtn" class="more-frequencies-btn">
                            <i class="fas fa-database"></i>
                            <span>Acessar Banco de Dados Completo</span>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Seção de Referências Científicas -->
            <section class="references-section">
                <h2 class="text-2xl font-semibold mb-6 text-purple-400">
                    <i class="fas fa-book-medical mr-2"></i>Referências Científicas
                </h2>
                
                <div id="scientificReferences" class="space-y-4">
                    <!-- Referências serão adicionadas aqui -->
                </div>
            </section>
        </main>

        <!-- Botão Voltar ao Topo -->
        <button id="topBtn" onclick="scrollToTop()" aria-label="Voltar ao topo">
            <i class="fas fa-arrow-up"></i>
        </button>
    </div>

    <!-- Modal de Banco de Dados Completo -->
    <div id="databaseModal" class="database-modal hidden">
        <div class="database-modal-content">
            <button id="closeDatabaseModal" class="database-modal-close">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="mb-6">
                <h2 class="text-3xl font-bold text-green-400 mb-2">Banco de Dados CAFL Completo</h2>
                <p class="text-gray-400">Acesse todas as frequências terapêuticas disponíveis no banco de dados CAFL</p>
            </div>
            
            <!-- Filtros Avançados -->
            <div class="filter-section mb-6">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div class="filter-group">
                        <label for="dbSearchInput" class="filter-label">Buscar</label>
                        <input type="text" id="dbSearchInput" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 transition" placeholder="Nome, descrição ou categoria">
                    </div>
                    
                    <div class="filter-group">
                        <label for="dbCategoryFilter" class="filter-label">Categoria</label>
                        <select id="dbCategoryFilter" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
                            <option value="all">Todas as Categorias</option>
                            <option value="Dor">Dor</option>
                            <option value="Concentração">Concentração</option>
                            <option value="Inflamação">Inflamação</option>
                            <option value="Energia">Energia</option>
                            <option value="Sono">Sono</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="dbEvidenceFilter" class="filter-label">Nível de Evidência</label>
                        <select id="dbEvidenceFilter" class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 transition">
                            <option value="all">Todos</option>
                            <option value="high">Alta Evidência</option>
                            <option value="medium">Média Evidência</option>
                            <option value="low">Baixa Evidência</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label for="dbFrequencyRange" class="filter-label">Faixa de Frequência</label>
                        <div class="range-slider-container">
                            <input type="range" id="dbFrequencyRange" class="range-slider" min="20" max="20000" value="10000">
                            <div class="range-value">20-20000 Hz</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Opções de Visualização -->
            <div class="view-options mb-4">
                <div class="items-per-page">
                    <span>Itens por página:</span>
                    <select id="itemsPerPage">
                        <option value="10">10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                        <option value="100">100</option>
                    </select>
                </div>
                <div class="view-buttons">
                    <button class="view-btn active" data-view="grid">
                        <i class="fas fa-th"></i>
                    </button>
                    <button class="view-btn" data-view="list">
                        <i class="fas fa-list"></i>
                    </button>
                </div>
            </div>
            
            <!-- Container de Frequências -->
            <div class="database-container" id="dbFrequenciesContainer">
                <div id="dbFrequenciesList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Cards de frequência serão adicionados aqui -->
                </div>
                
                <!-- Loading Spinner -->
                <div id="dbLoading" class="db-loading hidden">
                    <div class="db-loading-spinner"></div>
                </div>
                
                <!-- No Results Message -->
                <div id="dbNoResults" class="no-results hidden">
                    <div class="no-results-icon">
                        <i class="fas fa-search"></i>
                    </div>
                    <h3 class="text-xl font-medium mb-2">Nenhuma frequência encontrada</h3>
                    <p>Tente ajustar seus filtros ou termos de busca</p>
                </div>
            </div>
            
            <!-- Paginação -->
            <div class="pagination-container">
                <button id="dbPrevPageBtn" class="pagination-btn" disabled>
                    <i class="fas fa-chevron-left mr-2"></i>Anterior
                </button>
                <div class="pagination-info">
                    Página <span id="dbCurrentPage">1</span> de <span id="dbTotalPages">1</span>
                </div>
                <button id="dbNextPageBtn" class="pagination-btn" disabled>
                    Próximo<i class="fas fa-chevron-right ml-2"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Detalhes da Frequência -->
    <div id="detailModal" class="detail-modal hidden">
        <div class="detail-content">
            <button id="closeDetailModal" class="detail-close">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="detail-header">
                <h2 id="detailTitle" class="detail-title">Nome da Frequência</h2>
                <div id="detailSubtitle" class="detail-subtitle">40 Hz</div>
            </div>
            
            <div class="detail-tabs">
                <button class="detail-tab active" data-tab="overview">Visão Geral</button>
                <button class="detail-tab" data-tab="protocols">Protocolos</button>
                <button class="detail-tab" data-tab="evidence">Evidências</button>
                <button class="detail-tab" data-tab="safety">Segurança</button>
            </div>
            
            <div id="overviewTab" class="detail-tab-content active">
                <div class="detail-section">
                    <h3 class="detail-section-title">
                        <i class="fas fa-info-circle mr-2"></i>Descrição
                    </h3>
                    <p id="detailDescription">Descrição da frequência e seus benefícios terapêuticos.</p>
                </div>
                
                <div class="detail-section">
                    <h3 class="detail-section-title">
                        <i class="fas fa-tag mr-2"></i>Categoria
                    </h3>
                    <div id="detailCategory">
                        <span class="category-badge bg-blue-600">Concentração</span>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3 class="detail-section-title">
                        <i class="fas fa-star mr-2"></i>Benefícios
                    </h3>
                    <ul id="detailBenefits" class="list-disc pl-5 space-y-1">
                        <li>Melhora do foco e concentração</li>
                        <li>Aumento da clareza mental</li>
                        <li>Estímulo da atividade cognitiva</li>
                    </ul>
                </div>
                
                <div class="detail-section">
                    <h3 class="detail-section-title">
                        <i class="fas fa-link mr-2"></i>Sinergias
                    </h3>
                    <div id="detailSynergy">
                        <span class="synergy-tag">Ondas Alfa</span>
                        <span class="synergy-tag">Meditação</span>
                    </div>
                </div>
            </div>
            
            <div id="protocolsTab" class="detail-tab-content">
                <div class="detail-section">
                    <h3 class="detail-section-title">
                        <i class="fas fa-tasks mr-2"></i>Protocolos Recomendados
                    </h3>
                    <div id="detailProtocols">
                        <div class="protocol-item">
                            <div class="protocol-name">Protocolo de Foco Matinal</div>
                            <div>Use por 15 minutos pela manhã para aumentar a clareza mental e foco durante o dia.</div>
                            <div class="protocol-details">
                                <span><i class="fas fa-clock mr-1"></i> 15 min</span>
                                <span><i class="fas fa-wave-square mr-1"></i> Onda Senoidal</span>
                            </div>
                        </div>
                        <div class="protocol-item">
                            <div class="protocol-name">Protocolo de Estudo</div>
                            <div>Use durante sessões de estudo ou trabalho mental intenso para melhorar a retenção de informações.</div>
                            <div class="protocol-details">
                                <span><i class="fas fa-clock mr-1"></i> 30 min</span>
                                <span><i class="fas fa-wave-square mr-1"></i> Onda Senoidal</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="evidenceTab" class="detail-tab-content">
                <div class="detail-section">
                    <h3 class="detail-section-title">
                        <i class="fas fa-microscope mr-2"></i>Evidências Científicas
                    </h3>
                    <div id="detailEvidence">
                        <div class="evidence-item">
                            <div class="evidence-study">Estudo sobre Ondas Gama e Cognição</div>
                            <div class="evidence-year">2020</div>
                            <div class="evidence-description">Pesquisa demonstrando que a exposição a frequências de 40 Hz pode melhorar a atividade cognitiva em adultos.</div>
                        </div>
                        <div class="evidence-item">
                            <div class="evidence-study">Análise de Frequências Terapêuticas</div>
                            <div class="evidence-year">2018</div>
                            <div class="evidence-description">Revisão sistemática dos efeitos de diferentes frequências no desempenho cognitivo e bem-estar.</div>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h3 class="detail-section-title">
                        <i class="fas fa-book mr-2"></i>Referências
                    </h3>
                    <div id="detailReferences" class="references-container">
                        <div class="reference-item">Smith, J. et al. (2020). "Gamma Frequency Stimulation and Cognitive Enhancement". Journal of Neuroscience.</div>
                        <div class="reference-item">Johnson, R. & Lee, K. (2018). "Therapeutic Frequencies: A Comprehensive Review". Alternative Medicine Journal.</div>
                        <div class="reference-item">Garcia, M. et al. (2019). "Neural Oscillations and Brain Health". Nature Reviews Neuroscience.</div>
                    </div>
                </div>
            </div>
            
            <div id="safetyTab" class="detail-tab-content">
                <div class="detail-section">
                    <h3 class="detail-section-title">
                        <i class="fas fa-shield-alt mr-2"></i>Informações de Segurança
                    </h3>
                    <div id="detailSafety">
                        <div class="safety-item">
                            <i class="fas fa-exclamation-triangle safety-icon"></i>
                            <div>Não use em caso de epilepsia ou histórico de convulsões.</div>
                        </div>
                        <div class="safety-item">
                            <i class="fas fa-exclamation-triangle safety-icon"></i>
                            <div>Consulte um profissional de saúde antes de usar se estiver grávida.</div>
                        </div>
                        <div class="safety-item">
                            <i class="fas fa-exclamation-triangle safety-icon"></i>
                            <div>Use em volume moderado para evitar desconforto auditivo.</div>
                        </div>
                        <div class="safety-item">
                            <i class="fas fa-info-circle safety-icon"></i>
                            <div>Recomenda-se sessões de 15-30 minutos para iniciantes.</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variáveis globais
        let audioContext = null;
        let oscillator = null;
        let gainNode = null;
        let analyser = null;
        let isPlaying = false;
        let currentWaveType = 'sine';
        let timerInterval = null;
        let timerSeconds = 0;
        let history = [];
        let favorites = [];
        
        // Variáveis de paginação e filtros
        let dbCurrentPage = 1;
        let dbItemsPerPage = 20;
        let dbFilteredData = [...CAFL_DATABASE.fullDatabase];
        let currentView = 'grid';
        
        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            initializeAudio();
            setupEventListeners();
            updateMainFrequenciesList();
            updateScientificReferences();
            initializeWaveVisualizer();
            updateHistoryList();
        });
        
        // Inicializar contexto de áudio
        function initializeAudio() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                analyser = audioContext.createAnalyser();
                analyser.fftSize = 2048;
            } catch (e) {
                console.error('Web Audio API não suportada neste navegador.');
            }
        }
        
        // Configurar event listeners
        function setupEventListeners() {
            // Botões de reprodução
            document.getElementById('playBtn').addEventListener('click', playFrequency);
            document.getElementById('stopBtn').addEventListener('click', stopFrequency);
            
            // Controles de volume
            const volumeSlider = document.getElementById('volume');
            volumeSlider.addEventListener('input', function() {
                document.getElementById('volumeValue').textContent = this.value;
                if (gainNode) {
                    gainNode.gain.value = this.value / 100;
                }
            });
            
            // Seleção de tipo de onda
            document.querySelectorAll('.wave-type-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.wave-type-btn').forEach(b => {
                        b.classList.remove('bg-blue-600');
                        b.classList.add('bg-gray-700');
                    });
                    this.classList.remove('bg-gray-700');
                    this.classList.add('bg-blue-600');
                    currentWaveType = this.dataset.wave;
                    
                    if (oscillator) {
                        oscillator.type = currentWaveType;
                    }
                });
            });
            
            // Controles de timer
            document.getElementById('timerBtn').addEventListener('click', setupTimer);
            
            // Botão de favoritos
            document.getElementById('favoriteBtn').addEventListener('click', toggleFavorite);
            
            // Botão Mais Frequências
            document.getElementById('moreFrequenciesBtn').addEventListener('click', openDatabaseModal);
            
            // Modal de banco de dados
            document.getElementById('closeDatabaseModal').addEventListener('click', closeDatabaseModal);
            
            // Filtros do banco de dados
            document.getElementById('dbSearchInput').addEventListener('input', filterDbFrequencies);
            document.getElementById('dbCategoryFilter').addEventListener('change', filterDbFrequencies);
            document.getElementById('dbEvidenceFilter').addEventListener('change', filterDbFrequencies);
            document.getElementById('dbFrequencyRange').addEventListener('input', filterDbFrequencies);
            
            // Paginação do banco de dados
            document.getElementById('dbPrevPageBtn').addEventListener('click', () => changeDbPage(-1));
            document.getElementById('dbNextPageBtn').addEventListener('click', () => changeDbPage(1));
            
            // Itens por página
            document.getElementById('itemsPerPage').addEventListener('change', function() {
                dbItemsPerPage = parseInt(this.value);
                dbCurrentPage = 1;
                updateDbFrequenciesList();
            });
            
            // Visualização
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentView = this.dataset.view;
                    updateDbFrequenciesList();
                });
            });
            
            // Modal de detalhes
            document.getElementById('closeDetailModal').addEventListener('click', closeDetailModal);
            document.querySelectorAll('.detail-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.dataset.tab;
                    openDetailTab(tabName);
                });
            });
            
            // Botão voltar ao topo
            window.addEventListener('scroll', function() {
                if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                    document.getElementById('topBtn').classList.add('show');
                } else {
                    document.getElementById('topBtn').classList.remove('show');
                }
            });
        }
        
        // Reproduzir frequência
        function playFrequency() {
            if (!audioContext) {
                initializeAudio();
            }
            
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }
            
            const frequency = parseFloat(document.getElementById('frequency').value);
            
            if (isNaN(frequency) || frequency < 20 || frequency > 20000) {
                alert('Por favor, insira uma frequência válida entre 20 Hz e 20.000 Hz.');
                return;
            }
            
            stopFrequency(); // Parar qualquer som anterior
            
            oscillator = audioContext.createOscillator();
            gainNode = audioContext.createGain();
            
            oscillator.type = currentWaveType;
            oscillator.frequency.value = frequency;
            gainNode.gain.value = document.getElementById('volume').value / 100;
            
            oscillator.connect(gainNode);
            gainNode.connect(analyser);
            analyser.connect(audioContext.destination);
            
            oscillator.start();
            isPlaying = true;
            
            document.getElementById('playBtn').classList.add('hidden');
            document.getElementById('stopBtn').classList.remove('hidden');
            
            // Adicionar ao histórico
            addToHistory(frequency);
            
            // Atualizar informações da frequência atual
            updateCurrentFrequencyInfo(frequency);
            
            // Iniciar timer se configurado
            if (timerSeconds > 0) {
                startTimer();
            }
        }
        
        // Parar frequência
        function stopFrequency() {
            if (oscillator) {
                oscillator.stop();
                oscillator = null;
            }
            
            isPlaying = false;
            document.getElementById('playBtn').classList.remove('hidden');
            document.getElementById('stopBtn').classList.add('hidden');
            
            // Parar timer
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }
        
        // Configurar timer
        function setupTimer() {
            const minutes = prompt('Digite o tempo em minutos:', '5');
            if (minutes && !isNaN(minutes) && parseInt(minutes) > 0) {
                timerSeconds = parseInt(minutes) * 60;
                document.getElementById('timerContainer').classList.remove('hidden');
                updateTimerDisplay();
                
                if (isPlaying) {
                    startTimer();
                }
            }
        }
        
        // Iniciar timer
        function startTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            timerInterval = setInterval(() => {
                timerSeconds--;
                updateTimerDisplay();
                
                if (timerSeconds <= 0) {
                    clearInterval(timerInterval);
                    timerInterval = null;
                    stopFrequency();
                    alert('Tempo encerrado!');
                }
            }, 1000);
        }
        
        // Atualizar display do timer
        function updateTimerDisplay() {
            const hours = Math.floor(timerSeconds / 3600);
            const minutes = Math.floor((timerSeconds % 3600) / 60);
            const seconds = timerSeconds % 60;
            
            const display = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('timerDisplay').textContent = display;
            
            // Atualizar barra de progresso
            const totalTime = parseInt(document.getElementById('timerBtn').getAttribute('data-total-time')) || timerSeconds + (timerInterval ? 1 : 0);
            const progress = ((totalTime - timerSeconds) / totalTime) * 100;
            document.getElementById('timerProgress').style.width = `${progress}%`;
        }
        
        // Adicionar ao histórico
        function addToHistory(frequency) {
            const timestamp = new Date();
            const historyItem = {
                frequency: frequency,
                time: timestamp.toLocaleTimeString(),
                date: timestamp.toLocaleDateString()
            };
            
            history.unshift(historyItem);
            if (history.length > 10) {
                history = history.slice(0, 10);
            }
            
            updateHistoryList();
        }
        
        // Atualizar lista de histórico
        function updateHistoryList() {
            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';
            
            if (history.length === 0) {
                historyList.innerHTML = '<p class="text-gray-500 text-sm">Nenhum histórico recente</p>';
                return;
            }
            
            history.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'flex justify-between items-center py-1 px-2 bg-gray-700 rounded text-sm';
                historyItem.innerHTML = `
                    <span>${item.frequency} Hz</span>
                    <span class="text-gray-400">${item.time}</span>
                `;
                historyItem.addEventListener('click', () => {
                    document.getElementById('frequency').value = item.frequency;
                    updateCurrentFrequencyInfo(item.frequency);
                });
                historyList.appendChild(historyItem);
            });
        }
        
        // Atualizar informações da frequência atual
        function updateCurrentFrequencyInfo(frequency) {
            // Buscar informações no banco de dados principal
            const frequencyInfo = CAFL_DATABASE.mainFrequencies.find(item => item.frequency === frequency);
            
            if (frequencyInfo) {
                document.getElementById('currentInfo').innerHTML = `
                    <div class="text-xl font-bold text-blue-400">${frequencyInfo.frequency} Hz</div>
                    <div class="text-lg font-medium">${frequencyInfo.name}</div>
                `;
                
                document.getElementById('currentDetails').innerHTML = `
                    <div><strong>Categoria:</strong> <span class="category-badge bg-blue-600">${frequencyInfo.category}</span></div>
                    <div><strong>Descrição:</strong> ${frequencyInfo.description}</div>
                `;
                
                // Recomendação de tipo de onda
                let waveRecommendation = 'Senoidal - Proporciona uma experiência mais suave e agradável.';
                if (frequencyInfo.category === 'Energia') {
                    waveRecommendation = 'Quadrada - Proporciona uma estimulação mais energética.';
                } else if (frequencyInfo.category === 'Sono') {
                    waveRecommendation = 'Senoidal - Proporciona uma experiência mais relaxante.';
                }
                
                document.getElementById('waveRecommendation').innerHTML = `
                    <div class="flex items-center gap-2">
                        <i class="fas fa-lightbulb text-yellow-500"></i>
                        <span><strong>Onda recomendada:</strong> ${waveRecommendation}</span>
                    </div>
                `;
                
                // Atualizar botão de favoritos
                const isFavorite = favorites.some(fav => fav.id === frequencyInfo.id);
                document.getElementById('favoriteBtn').innerHTML = isFavorite ? 
                    '<i class="fas fa-star mr-2"></i>Remover dos Favoritos' : 
                    '<i class="far fa-star mr-2"></i>Adicionar aos Favoritos';
                
                document.getElementById('favoriteBtn').dataset.frequencyId = frequencyInfo.id;
            } else {
                document.getElementById('currentInfo').innerHTML = `
                    <div class="text-xl font-bold text-blue-400">${frequency} Hz</div>
                    <div class="text-lg font-medium">Frequência Personalizada</div>
                `;
                
                document.getElementById('currentDetails').innerHTML = `
                    <div><strong>Categoria:</strong> <span class="category-badge bg-purple-600">Personalizada</span></div>
                    <div><strong>Descrição:</strong> Frequência definida pelo usuário</div>
                `;
                
                document.getElementById('waveRecommendation').innerHTML = `
                    <div class="flex items-center gap-2">
                        <i class="fas fa-lightbulb text-yellow-500"></i>
                        <span><strong>Onda recomendada:</strong> Senoidal - Proporciona uma experiência mais suave e agradável.</span>
                    </div>
                `;
                
                document.getElementById('favoriteBtn').innerHTML = '<i class="far fa-star mr-2"></i>Adicionar aos Favoritos';
                document.getElementById('favoriteBtn').dataset.frequencyId = '';
            }
        }
        
        // Alternar favoritos
        function toggleFavorite() {
            const frequencyId = document.getElementById('favoriteBtn').dataset.frequencyId;
            
            if (!frequencyId) {
                // Adicionar frequência personalizada aos favoritos
                const frequency = parseFloat(document.getElementById('frequency').value);
                const customFavorite = {
                    id: `custom-${Date.now()}`,
                    name: `Frequência Personalizada (${frequency} Hz)`,
                    frequency: frequency,
                    category: "Personalizada",
                    description: "Frequência definida pelo usuário",
                    evidence: "low",
                    benefits: [],
                    protocols: [],
                    references: [],
                    synergy: [],
                    safety: ""
                };
                
                favorites.push(customFavorite);
                document.getElementById('favoriteBtn').innerHTML = '<i class="fas fa-star mr-2"></i>Remover dos Favoritos';
                document.getElementById('favoriteBtn').dataset.frequencyId = customFavorite.id;
                
                alert('Frequência adicionada aos favoritos!');
                return;
            }
            
            const index = favorites.findIndex(fav => fav.id === frequencyId);
            
            if (index !== -1) {
                // Remover dos favoritos
                favorites.splice(index, 1);
                document.getElementById('favoriteBtn').innerHTML = '<i class="far fa-star mr-2"></i>Adicionar aos Favoritos';
                alert('Removido dos favoritos!');
            } else {
                // Adicionar aos favoritos
                const frequencyInfo = CAFL_DATABASE.mainFrequencies.find(item => item.id === frequencyId);
                if (frequencyInfo) {
                    favorites.push(frequencyInfo);
                    document.getElementById('favoriteBtn').innerHTML = '<i class="fas fa-star mr-2"></i>Remover dos Favoritos';
                    alert('Adicionado aos favoritos!');
                }
            }
        }
        
        // Atualizar lista de frequências principais
        function updateMainFrequenciesList() {
            const mainFrequenciesList = document.getElementById('mainFrequenciesList');
            mainFrequenciesList.innerHTML = '';
            
            CAFL_DATABASE.mainFrequencies.forEach(item => {
                const frequencyCard = createFrequencyCard(item);
                mainFrequenciesList.appendChild(frequencyCard);
            });
        }
        
        // Atualizar referências científicas
        function updateScientificReferences() {
            const referencesContainer = document.getElementById('scientificReferences');
            referencesContainer.innerHTML = '';
            
            CAFL_DATABASE.scientificReferences.forEach(reference => {
                const referenceCard = document.createElement('div');
                referenceCard.className = 'reference-card';
                referenceCard.innerHTML = `
                    <h3 class="reference-title">${reference.title}</h3>
                    <div class="reference-authors">${reference.authors} (${reference.year})</div>
                    <div class="reference-journal">${reference.journal}, ${reference.volume}${reference.issue ? `(${reference.issue})` : ''}, pp. ${reference.pages}</div>
                    <p class="reference-summary">${reference.summary}</p>
                    <a href="https://doi.org/${reference.doi}" target="_blank" class="reference-doi">DOI: ${reference.doi}</a>
                `;
                referencesContainer.appendChild(referenceCard);
            });
        }
        
        // Criar card de frequência
        function createFrequencyCard(item) {
            const card = document.createElement('div');
            card.className = 'frequency-card bg-gray-700 rounded-lg p-4 cursor-pointer';
            card.dataset.frequencyId = item.id;
            
            const evidenceClass = `evidence-${item.evidence}`;
            
            card.innerHTML = `
                <div class="flex justify-between items-start mb-2">
                    <h3 class="font-semibold text-lg">${item.name}</h3>
                    <span class="evidence-badge ${evidenceClass}">${item.evidence === 'high' ? 'Alta' : item.evidence === 'medium' ? 'Média' : 'Baixa'}</span>
                </div>
                <div class="text-2xl font-bold text-blue-400 mb-2">${item.frequency} Hz</div>
                <div class="mb-3">
                    <span class="category-badge bg-blue-600">${item.category}</span>
                </div>
                <p class="text-sm text-gray-300 mb-4">${item.description}</p>
                <div class="flex justify-between items-center">
                    <button class="play-frequency-btn bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm transition">
                        <i class="fas fa-play mr-1"></i> Tocar
                    </button>
                    <button class="view-details-btn text-gray-400 hover:text-white transition">
                        <i class="fas fa-info-circle"></i> Detalhes
                    </button>
                </div>
            `;
            
            // Event listeners
            card.querySelector('.play-frequency-btn').addEventListener('click', (e) => {
                e.stopPropagation();
                document.getElementById('frequency').value = item.frequency;
                updateCurrentFrequencyInfo(item.frequency);
                playFrequency();
            });
            
            card.querySelector('.view-details-btn').addEventListener('click', (e) => {
                e.stopPropagation();
                showFrequencyDetails(item);
            });
            
            card.addEventListener('click', () => {
                document.getElementById('frequency').value = item.frequency;
                updateCurrentFrequencyInfo(item.frequency);
            });
            
            return card;
        }
        
        // Abrir modal de banco de dados
        function openDatabaseModal() {
            document.getElementById('databaseModal').classList.remove('hidden');
            updateDbFrequenciesList();
        }
        
        // Fechar modal de banco de dados
        function closeDatabaseModal() {
            document.getElementById('databaseModal').classList.add('hidden');
        }
        
        // Filtrar frequências do banco de dados
        function filterDbFrequencies() {
            const searchTerm = document.getElementById('dbSearchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('dbCategoryFilter').value;
            const evidenceFilter = document.getElementById('dbEvidenceFilter').value;
            const maxFrequency = parseInt(document.getElementById('dbFrequencyRange').value);
            
            dbFilteredData = CAFL_DATABASE.fullDatabase.filter(item => {
                const matchesSearch = searchTerm === '' || 
                    item.name.toLowerCase().includes(searchTerm) || 
                    item.description.toLowerCase().includes(searchTerm) ||
                    item.category.toLowerCase().includes(searchTerm);
                
                const matchesCategory = categoryFilter === 'all' || item.category === categoryFilter;
                const matchesEvidence = evidenceFilter === 'all' || item.evidence === evidenceFilter;
                const matchesFrequency = item.frequency <= maxFrequency;
                
                return matchesSearch && matchesCategory && matchesEvidence && matchesFrequency;
            });
            
            dbCurrentPage = 1;
            updateDbFrequenciesList();
            
            // Atualizar texto da faixa de frequência
            document.querySelector('.range-value').textContent = `20-${maxFrequency} Hz`;
        }
        
        // Atualizar lista de frequências do banco de dados
        function updateDbFrequenciesList() {
            const dbFrequenciesList = document.getElementById('dbFrequenciesList');
            dbFrequenciesList.innerHTML = '';
            
            const startIndex = (dbCurrentPage - 1) * dbItemsPerPage;
            const endIndex = startIndex + dbItemsPerPage;
            const paginatedData = dbFilteredData.slice(startIndex, endIndex);
            
            if (paginatedData.length === 0) {
                document.getElementById('dbNoResults').classList.remove('hidden');
                document.getElementById('dbFrequenciesList').classList.add('hidden');
            } else {
                document.getElementById('dbNoResults').classList.add('hidden');
                document.getElementById('dbFrequenciesList').classList.remove('hidden');
                
                if (currentView === 'grid') {
                    dbFrequenciesList.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4';
                    
                    paginatedData.forEach(item => {
                        const frequencyCard = createDbFrequencyCard(item);
                        dbFrequenciesList.appendChild(frequencyCard);
                    });
                } else {
                    dbFrequenciesList.className = 'space-y-4';
                    
                    paginatedData.forEach(item => {
                        const listItem = createDbFrequencyListItem(item);
                        dbFrequenciesList.appendChild(listItem);
                    });
                }
            }
            
            updateDbPagination();
        }
        
        // Criar card de frequência para o banco de dados
        function createDbFrequencyCard(item) {
            const card = document.createElement('div');
            card.className = 'frequency-card bg-gray-700 rounded-lg p-4 cursor-pointer';
            card.dataset.frequencyId = item.id;
            
            const evidenceClass = item.evidence ? `evidence-${item.evidence}` : 'evidence-low';
            
            card.innerHTML = `
                <div class="flex justify-between items-start mb-2">
                    <h3 class="font-semibold text-lg">${item.name}</h3>
                    <span class="evidence-badge ${evidenceClass}">${item.evidence === 'high' ? 'Alta' : item.evidence === 'medium' ? 'Média' : 'Baixa'}</span>
                </div>
                <div class="text-2xl font-bold text-blue-400 mb-2">${item.frequency} Hz</div>
                <div class="mb-3">
                    <span class="category-badge bg-blue-600">${item.category}</span>
                </div>
                <p class="text-sm text-gray-300 mb-4">${item.description}</p>
                <div class="flex justify-between items-center">
                    <button class="play-frequency-btn bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm transition">
                        <i class="fas fa-play mr-1"></i> Tocar
                    </button>
                    <button class="view-details-btn text-gray-400 hover:text-white transition">
                        <i class="fas fa-info-circle"></i> Detalhes
                    </button>
                </div>
            `;
            
            // Event listeners
            card.querySelector('.play-frequency-btn').addEventListener('click', (e) => {
                e.stopPropagation();
                document.getElementById('frequency').value = item.frequency;
                updateCurrentFrequencyInfo(item.frequency);
                playFrequency();
            });
            
            card.querySelector('.view-details-btn').addEventListener('click', (e) => {
                e.stopPropagation();
                showFrequencyDetails(item);
            });
            
            card.addEventListener('click', () => {
                document.getElementById('frequency').value = item.frequency;
                updateCurrentFrequencyInfo(item.frequency);
            });
            
            return card;
        }
        
        // Criar item de lista de frequência para o banco de dados
        function createDbFrequencyListItem(item) {
            const listItem = document.createElement('div');
            listItem.className = 'bg-gray-700 rounded-lg p-4 flex items-center';
            listItem.dataset.frequencyId = item.id;
            
            const evidenceClass = item.evidence ? `evidence-${item.evidence}` : 'evidence-low';
            
            listItem.innerHTML = `
                <div class="flex-1">
                    <div class="flex items-center mb-1">
                        <h3 class="font-semibold text-lg mr-2">${item.name}</h3>
                        <span class="evidence-badge ${evidenceClass}">${item.evidence === 'high' ? 'Alta' : item.evidence === 'medium' ? 'Média' : 'Baixa'}</span>
                        <span class="category-badge bg-blue-600 ml-2">${item.category}</span>
                    </div>
                    <div class="text-xl font-bold text-blue-400">${item.frequency} Hz</div>
                    <p class="text-sm text-gray-300 mt-1">${item.description}</p>
                </div>
                <div class="flex flex-col space-y-2">
                    <button class="play-frequency-btn bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm transition">
                        <i class="fas fa-play mr-1"></i> Tocar
                    </button>
                    <button class="view-details-btn text-gray-400 hover:text-white transition">
                        <i class="fas fa-info-circle"></i> Detalhes
                    </button>
                </div>
            `;
            
            // Event listeners
            listItem.querySelector('.play-frequency-btn').addEventListener('click', (e) => {
                e.stopPropagation();
                document.getElementById('frequency').value = item.frequency;
                updateCurrentFrequencyInfo(item.frequency);
                playFrequency();
            });
            
            listItem.querySelector('.view-details-btn').addEventListener('click', (e) => {
                e.stopPropagation();
                showFrequencyDetails(item);
            });
            
            listItem.addEventListener('click', () => {
                document.getElementById('frequency').value = item.frequency;
                updateCurrentFrequencyInfo(item.frequency);
            });
            
            return listItem;
        }
        
        // Mostrar detalhes da frequência
        function showFrequencyDetails(item) {
            document.getElementById('detailTitle').textContent = item.name;
            document.getElementById('detailSubtitle').textContent = `${item.frequency} Hz`;
            document.getElementById('detailDescription').textContent = item.description || 'Descrição não disponível para esta frequência.';
            
            // Categoria
            document.getElementById('detailCategory').innerHTML = 
                `<span class="category-badge bg-blue-600">${item.category}</span>`;
            
            // Benefícios
            const benefitsList = document.getElementById('detailBenefits');
            benefitsList.innerHTML = '';
            if (item.benefits && item.benefits.length > 0) {
                item.benefits.forEach(benefit => {
                    const li = document.createElement('li');
                    li.textContent = benefit;
                    benefitsList.appendChild(li);
                });
            } else {
                benefitsList.innerHTML = '<li>Não há benefícios específicos documentados para esta frequência.</li>';
            }
            
            // Sinergias
            const synergyDiv = document.getElementById('detailSynergy');
            synergyDiv.innerHTML = '';
            if (item.synergy && item.synergy.length > 0) {
                item.synergy.forEach(synergy => {
                    const span = document.createElement('span');
                    span.className = 'synergy-tag';
                    span.textContent = synergy;
                    synergyDiv.appendChild(span);
                });
            } else {
                synergyDiv.innerHTML = '<p class="text-gray-400">Não há sinergias documentadas para esta frequência.</p>';
            }
            
            // Protocolos
            const protocolsDiv = document.getElementById('detailProtocols');
            protocolsDiv.innerHTML = '';
            if (item.protocols && item.protocols.length > 0) {
                item.protocols.forEach(protocol => {
                    const protocolDiv = document.createElement('div');
                    protocolDiv.className = 'protocol-item';
                    protocolDiv.innerHTML = `
                        <div class="protocol-name">${protocol.name}</div>
                        <div>${protocol.description}</div>
                        <div class="protocol-details">
                            <span><i class="fas fa-clock mr-1"></i> ${protocol.steps.reduce((total, step) => total + step.duration, 0)} min</span>
                            <span><i class="fas fa-wave-square mr-1"></i> ${protocol.steps[0].waveType === 'sine' ? 'Onda Senoidal' : 
                                protocol.steps[0].waveType === 'square' ? 'Onda Quadrada' : 
                                protocol.steps[0].waveType === 'sawtooth' ? 'Onda Dente de Serra' : 'Onda Triangular'}</span>
                        </div>
                    `;
                    protocolsDiv.appendChild(protocolDiv);
                });
            } else {
                protocolsDiv.innerHTML = '<p class="text-gray-400">Não há protocolos específicos documentados para esta frequência.</p>';
            }
            
            // Evidências
            const evidenceDiv = document.getElementById('detailEvidence');
            evidenceDiv.innerHTML = '';
            if (item.references && item.references.length > 0) {
                item.references.forEach((reference, index) => {
                    const evidenceItem = document.createElement('div');
                    evidenceItem.className = 'evidence-item';
                    evidenceItem.innerHTML = `
                        <div class="evidence-study">Referência ${index + 1}</div>
                        <div class="evidence-description">${reference}</div>
                    `;
                    evidenceDiv.appendChild(evidenceItem);
                });
            } else {
                evidenceDiv.innerHTML = '<p class="text-gray-400">Não há evidências científicas específicas documentadas para esta frequência.</p>';
            }
            
            // Referências
            const referencesDiv = document.getElementById('detailReferences');
            referencesDiv.innerHTML = '';
            if (item.references && item.references.length > 0) {
                item.references.forEach(reference => {
                    const referenceItem = document.createElement('div');
                    referenceItem.className = 'reference-item';
                    referenceItem.textContent = reference;
                    referencesDiv.appendChild(referenceItem);
                });
            } else {
                referencesDiv.innerHTML = '<p class="text-gray-400">Não há referências específicas documentadas para esta frequência.</p>';
            }
            
            // Segurança
            const safetyDiv = document.getElementById('detailSafety');
            safetyDiv.innerHTML = '';
            if (item.safety) {
                const safetyItem = document.createElement('div');
                safetyItem.className = 'safety-item';
                safetyItem.innerHTML = `
                    <i class="fas fa-info-circle safety-icon"></i>
                    <div>${item.safety}</div>
                `;
                safetyDiv.appendChild(safetyItem);
            } else {
                safetyDiv.innerHTML = `
                    <div class="safety-item">
                        <i class="fas fa-info-circle safety-icon"></i>
                        <div>Use em volume moderado para evitar desconforto auditivo.</div>
                    </div>
                    <div class="safety-item">
                        <i class="fas fa-exclamation-triangle safety-icon"></i>
                        <div>Consulte um profissional de saúde antes de usar se estiver grávida.</div>
                    </div>
                    <div class="safety-item">
                        <i class="fas fa-exclamation-triangle safety-icon"></i>
                        <div>Não use em caso de epilepsia ou histórico de convulsões.</div>
                    </div>
                `;
            }
            
            // Abrir modal
            document.getElementById('detailModal').classList.remove('hidden');
            openDetailTab('overview');
        }
        
        // Fechar modal de detalhes
        function closeDetailModal() {
            document.getElementById('detailModal').classList.add('hidden');
        }
        
        // Abrir aba de detalhes
        function openDetailTab(tabName) {
            // Ocultar todas as abas
            document.querySelectorAll('.detail-tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remover classe ativa de todos os botões
            document.querySelectorAll('.detail-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Mostrar aba selecionada
            document.getElementById(`${tabName}Tab`).classList.add('active');
            
            // Adicionar classe ativa ao botão correspondente
            document.querySelector(`.detail-tab[data-tab="${tabName}"]`).classList.add('active');
        }
        
        // Atualizar paginação do banco de dados
        function updateDbPagination() {
            const totalPages = Math.ceil(dbFilteredData.length / dbItemsPerPage);
            
            document.getElementById('dbCurrentPage').textContent = dbCurrentPage;
            document.getElementById('dbTotalPages').textContent = totalPages;
            
            document.getElementById('dbPrevPageBtn').disabled = dbCurrentPage === 1;
            document.getElementById('dbNextPageBtn').disabled = dbCurrentPage === totalPages || totalPages === 0;
        }
        
        // Mudar página do banco de dados
        function changeDbPage(direction) {
            const totalPages = Math.ceil(dbFilteredData.length / dbItemsPerPage);
            const newPage = dbCurrentPage + direction;
            
            if (newPage >= 1 && newPage <= totalPages) {
                dbCurrentPage = newPage;
                updateDbFrequenciesList();
            }
        }
        
        // Inicializar visualizador de onda
        function initializeWaveVisualizer() {
            const canvas = document.getElementById('waveCanvas');
            const canvasCtx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            canvasCtx.clearRect(0, 0, width, height);
            
            // Desenhar onda inicial
            drawWaveform(canvasCtx, width, height, 40, 'sine');
        }
        
        // Desenhar forma de onda
        function drawWaveform(ctx, width, height, frequency, waveType) {
            ctx.clearRect(0, 0, width, height);
            ctx.beginPath();
            ctx.lineWidth = 2;
            ctx.strokeStyle = '#3b82f6';
            
            const samples = width;
            const amplitude = height / 3;
            const centerY = height / 2;
            
            for (let i = 0; i < samples; i++) {
                const x = i;
                let y;
                
                switch (waveType) {
                    case 'sine':
                        y = centerY + amplitude * Math.sin(2 * Math.PI * frequency * i / (samples * 10));
                        break;
                    case 'square':
                        y = centerY + amplitude * (Math.sin(2 * Math.PI * frequency * i / (samples * 10)) > 0 ? 1 : -1);
                        break;
                    case 'sawtooth':
                        const period = samples / (frequency / 10);
                        const phase = (i % period) / period;
                        y = centerY + amplitude * (2 * phase - 1);
                        break;
                    case 'triangle':
                        const trianglePeriod = samples / (frequency / 10);
                        const trianglePhase = (i % trianglePeriod) / trianglePeriod;
                        y = centerY + amplitude * (trianglePhase < 0.5 ? 4 * trianglePhase - 1 : 3 - 4 * trianglePhase);
                        break;
                    default:
                        y = centerY;
                }
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            
            ctx.stroke();
        }
        
        // Atualizar visualizador de onda em tempo real
        function updateWaveVisualizer() {
            if (!analyser) return;
            
            const canvas = document.getElementById('waveCanvas');
            const canvasCtx = canvas.getContext('2d');
            const width = canvas.width;
            const height = canvas.height;
            
            const bufferLength = analyser.frequencyBinCount;
            const dataArray = new Uint8Array(bufferLength);
            
            function draw() {
                if (!isPlaying) return;
                
                requestAnimationFrame(draw);
                
                analyser.getByteTimeDomainData(dataArray);
                
                canvasCtx.fillStyle = 'rgba(15, 23, 42, 0.1)';
                canvasCtx.fillRect(0, 0, width, height);
                
                canvasCtx.lineWidth = 2;
                canvasCtx.strokeStyle = '#3b82f6';
                canvasCtx.beginPath();
                
                const sliceWidth = width / bufferLength;
                let x = 0;
                
                for (let i = 0; i < bufferLength; i++) {
                    const v = dataArray[i] / 128.0;
                    const y = v * height / 2;
                    
                    if (i === 0) {
                        canvasCtx.moveTo(x, y);
                    } else {
                        canvasCtx.lineTo(x, y);
                    }
                    
                    x += sliceWidth;
                }
                
                canvasCtx.lineTo(width, height / 2);
                canvasCtx.stroke();
            }
            
            draw();
        }
        
        // Voltar ao topo
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
        
        // Atualizar visualizador de onda quando a frequência mudar
        document.getElementById('frequency').addEventListener('input', function() {
            const frequency = parseFloat(this.value);
            if (!isNaN(frequency) && frequency >= 20 && frequency <= 20000) {
                const canvas = document.getElementById('waveCanvas');
                const canvasCtx = canvas.getContext('2d');
                drawWaveform(canvasCtx, canvas.width, canvas.height, frequency, currentWaveType);
            }
        });
        
        // Atualizar visualizador de onda quando o tipo de onda mudar
        document.querySelectorAll('.wave-type-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const frequency = parseFloat(document.getElementById('frequency').value);
                if (!isNaN(frequency) && frequency >= 20 && frequency <= 20000) {
                    const canvas = document.getElementById('waveCanvas');
                    const canvasCtx = canvas.getContext('2d');
                    drawWaveform(canvasCtx, canvas.width, canvas.height, frequency, this.dataset.wave);
                }
            });
        });
        
        // Iniciar atualização do visualizador de onda em tempo real quando a reprodução começar
        document.getElementById('playBtn').addEventListener('click', function() {
            setTimeout(updateWaveVisualizer, 100);
        });
    </script>
</body>
</html>
